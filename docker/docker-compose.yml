version: '3.4'

networks:
  my-network:
    driver: bridge  

services:
  rabbitmq:
    container_name: RabbitMQ
    image: rabbitmq:3-management-alpine
    networks:
        - my-network

  redis:
    container_name: RedisData
    image: redis:latest
    restart: always
    networks:
        - my-network

  # redis_insight:
  #     container_name: RedisInsight  
  #     image: redislabs/redisinsight:latest
  #     restart: always
  #     networks:
  #         - my-network      

  mssqldb:
    container_name: MssqlDB
    image: mcr.microsoft.com/mssql/server:2022-latest
    networks:
        - my-network
        
  identityserver:
    container_name: IdentityServer
    build:
      context: ..
      dockerfile: ./src/IdentityServer/OpenIddictAPI/Dockerfile    
    depends_on:
      - mssqldb
    networks:
        - my-network

  gateway-api:
    container_name: gateway-api
    build:
      context: ..
      dockerfile: ./src/GatewayApi/Dockerfile      
    networks:
        - my-network
  # product:
  #   container_name: product
  #   build:
  #     context: ..
  #     dockerfile: ./src/ProductAPI/Dockerfile
  #   depends_on:
  #     - sqlserver

  # order:
  #   container_name: order
  #   build:
  #     context: ..
  #     dockerfile: ./src/OrderAPI/Dockerfile
  #   depends_on:
  #     - sqlserver
  